#!/bin/bash

SCRIPT=$(readlink -f $BASH_SOURCE[0])
SCRIPT_DIR=$(dirname $SCRIPT)
source $SCRIPT_DIR/config.sh

# Hadoop
sed -i 's,CONFIGURE_YARN_LOG_DIR,'$PROJECT_TMP'/yarn-logs,g' $HADOOP_CONF_DIR/yarn-env.sh
sed -i 's,CONFIGURE_YARN_LOCAL_DIR,'$PROJECT_TMP'/yarn-local-dir,g' $HADOOP_CONF_DIR/yarn-site.xml
sed -i 's,CONFIGURE_YARN_RESOURCEMANAGER,'$YARN_RESOURCEMANAGER',g' $HADOOP_CONF_DIR/yarn-site.xml

# Spark
sed -i 's,CONFIGURE_SPARK_YARN_STAGING_DIR,'$PROJECT_TMP'/spark-yarn-staging-dir,g' $SPARK_CONF_DIR/spark-defaults.conf

# Tardis
sed -i 's,CONFIGURE_YARN_RESOURCEMANAGER,'$YARN_RESOURCEMANAGER',g' $COBALD_TARDIS_CONFIG_DIR/tardis.yml
sed -i 's,CONFIGURE_COBALD_TARDIS_DRONES_DATABASE,'$COBALD_TARDIS_DRONES_DATABASE',g' $COBALD_TARDIS_CONFIG_DIR/tardis.yml
sed -i 's,CONFIGURE_COBALD_TARDIS_CONDOR_LOG_DIR,'$COBALD_TARDIS_CONDOR_LOG_DIR',g' $COBALD_TARDIS_CONFIG_DIR/drone.jdl
sed -i 's,CONFIGURE_PROJECT_HOME,'$PROJECT_HOME',g' $COBALD_TARDIS_CONFIG_DIR/drone.sh
